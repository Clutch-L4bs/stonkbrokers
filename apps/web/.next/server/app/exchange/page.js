(()=>{var a={};a.id=806,a.ids=[806],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},28354:a=>{"use strict";a.exports=require("util")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30783:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["exchange",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,69056)),"/Volumes/2Tb-Backup/NFT Robinhood Chain/apps/web/app/exchange/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,16953)),"/Volumes/2Tb-Backup/NFT Robinhood Chain/apps/web/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"]}]}.children,I=["/Volumes/2Tb-Backup/NFT Robinhood Chain/apps/web/app/exchange/page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/exchange/page",pathname:"/exchange",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/exchange/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},33873:a=>{"use strict";a.exports=require("path")},37632:(a,b,c)=>{"use strict";c.d(b,{PoolsPanel:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call PoolsPanel() from the server but PoolsPanel is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Volumes/2Tb-Backup/NFT Robinhood Chain/apps/web/app/exchange/pools/PoolsPanel.tsx","PoolsPanel")},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},52402:(a,b,c)=>{"use strict";c.d(b,{SwapPanel:()=>y});var d=c(21124),e=c(38301),f=c(42378),g=c(29808),h=c(79426),i=c(20596),j=c(85258),k=c(69656);c(93992);var l=c(20003),m=c(85365),n=c(39632),o=c(66335),p=c(16140);let q=[{label:"0.05%",fee:500,hint:"Stables"},{label:"0.30%",fee:3e3,hint:"Standard"},{label:"1.00%",fee:1e4,hint:"Volatile"}],r=[{label:"0.5%",bps:50},{label:"1%",bps:100},{label:"3%",bps:300}],s=[{type:"function",name:"deposit",stateMutability:"payable",inputs:[],outputs:[]},{type:"function",name:"withdraw",stateMutability:"nonpayable",inputs:[{name:"wad",type:"uint256"}],outputs:[]}],t={address:"0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",symbol:"ETH",decimals:18,logoURI:""};function u(a){return a.toLowerCase()===t.address.toLowerCase()}function v(a){return!!m.$.weth&&a.toLowerCase()===m.$.weth.toLowerCase()}function w(a,b=6){let c=Number(a);return isNaN(c)||0===c?"0":c>=1e6?`${(c/1e6).toFixed(2)}M`:c>=1e3?`${(c/1e3).toFixed(2)}K`:c>=1?c.toFixed(Math.min(4,b)):c>=1e-4?c.toFixed(b):c.toExponential(2)}function x({tokens:a,value:b,onChange:c,customAddr:f,onCustomAddr:g,customMeta:h,label:i,balance:j,symbol:l,onMax:m,amount:n,onAmountChange:o,amountReadonly:p,quoteDisplay:q,isNativeEth:r}){let s="__custom__"===b,[u,v]=(0,e.useState)(!1),x=(0,e.useRef)(null),y=[{addr:t.address,symbol:"ETH",hint:"Native",isEth:!0},...a.map(a=>({addr:a.address,symbol:a.symbol,hint:a.address.slice(0,6)+"...",isEth:!1})),{addr:"__custom__",symbol:"Custom",hint:"Paste address",isEth:!1}],z=s?h?.symbol||"Custom":l||y.find(a=>a.addr===b)?.symbol||"Select";return(0,d.jsxs)("div",{className:"bg-lm-terminal-darkgray border border-lm-terminal-gray p-3 space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-[10px] lm-upper font-bold tracking-wider",children:i}),void 0!==j&&(0,d.jsxs)("div",{className:"text-lm-terminal-lightgray text-[10px] lm-mono flex items-center gap-1",children:[(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-2.5 h-2.5 opacity-60",children:(0,d.jsx)("path",{d:"M8 1a7 7 0 100 14A7 7 0 008 1zm-.5 3h1v1h-1V4zm-1 2h3v1h-1v3h1v1h-3V10h1V7h-1V6z"})}),(0,d.jsx)("span",{className:"text-white",children:w(j)})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)("div",{className:"relative flex-shrink-0",ref:x,children:[(0,d.jsxs)("button",{type:"button",onClick:()=>v(!u),className:"flex items-center gap-1.5 h-10 px-3 bg-lm-black border border-lm-terminal-gray hover:border-lm-orange transition-colors min-w-[100px]",children:[(0,d.jsx)("span",{className:"text-white font-bold text-sm",children:z}),(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-3 h-3 text-lm-terminal-lightgray",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M4.22 6.22a.75.75 0 011.06 0L8 8.94l2.72-2.72a.75.75 0 111.06 1.06l-3.25 3.25a.75.75 0 01-1.06 0L4.22 7.28a.75.75 0 010-1.06z",clipRule:"evenodd"})})]}),u&&(0,d.jsx)("div",{className:"absolute top-full left-0 mt-1 z-50 bg-lm-black border border-lm-orange w-56 max-h-60 overflow-y-auto shadow-lg",children:y.map(a=>{let e=b===a.addr;return(0,d.jsxs)("button",{type:"button",onClick:()=>{c(a.addr),v(!1)},className:`w-full text-left px-3 py-2 flex items-center justify-between transition-colors ${e?"bg-lm-orange/10 text-lm-orange":"text-white hover:bg-lm-terminal-darkgray"}`,children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"font-bold text-sm",children:a.symbol}),a.isEth&&(0,d.jsx)("span",{className:"text-lm-terminal-lightgray text-[10px] ml-1.5",children:"Native"})]}),(0,d.jsx)("span",{className:"text-lm-terminal-lightgray text-[10px] lm-mono",children:a.hint})]},a.addr)})})]}),(0,d.jsx)("div",{className:"flex-1 relative",children:p&&void 0!==q?(0,d.jsx)("div",{className:"h-10 bg-lm-black border border-lm-terminal-gray px-3 flex items-center justify-end",children:(0,d.jsx)("span",{className:`lm-mono text-sm ${q&&"No liquidity"!==q?"text-white font-bold":"text-lm-terminal-lightgray"}`,children:q||"—"})}):(0,d.jsx)(k.p,{value:n||"",onValueChange:o,placeholder:"0.0",className:"h-10 text-sm font-bold"})}),m&&j&&Number(j)>0&&(0,d.jsx)("button",{type:"button",onClick:m,className:"h-10 px-2 text-[10px] font-bold text-lm-orange border border-lm-orange/30 hover:border-lm-orange hover:bg-lm-orange/5 transition-colors lm-upper",children:"Max"})]}),s&&(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("input",{className:"lm-input text-left text-xs h-8",placeholder:"Paste token address (0x...)",value:f,onChange:a=>g(a.target.value)}),h?(0,d.jsxs)("div",{className:"text-lm-green text-[10px] flex items-center gap-1",children:[(0,d.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-lm-green"}),"Detected: ",(0,d.jsx)("span",{className:"text-white font-bold",children:h.symbol})," (",h.decimals," decimals)"]}):42===f.length?(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-[10px] animate-pulse",children:"Detecting token..."}):null]}),r&&(0,d.jsxs)("div",{className:"text-[9px] text-lm-terminal-lightgray flex items-center gap-1",children:[(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-2.5 h-2.5",children:(0,d.jsx)("path",{d:"M8 1a7 7 0 100 14A7 7 0 008 1zm-.5 3h1v1h-1V4zm-1 2h3v1h-1v3h1v1h-3V10h1V7h-1V6z"})}),"Auto-wraps to WETH for the swap"]})]})}function y(){var a;let{address:b,walletClient:c,requireCorrectChain:k}=(0,o.v)();(0,f.useSearchParams)();let[y,z]=(0,e.useState)([]),[A,B]=(0,e.useState)(""),[C,D]=(0,e.useState)(""),[E,F]=(0,e.useState)(""),[G,H]=(0,e.useState)(""),[I,J]=(0,e.useState)(null),[K,L]=(0,e.useState)(null),[M,N]=(0,e.useState)(3e3),[O,P]=(0,e.useState)(""),[Q,R]=(0,e.useState)(0n),[S,T]=(0,e.useState)(""),[U,V]=(0,e.useState)(!1),[W,X]=(0,e.useState)(100),[Y,Z]=(0,e.useState)(!1),[$,_]=(0,e.useState)(""),[aa,ab]=(0,e.useState)("info"),[ac,ad]=(0,e.useState)(!1),[ae,af]=(0,e.useState)(""),[ag,ah]=(0,e.useState)(""),[ai,aj]=(0,e.useState)("");(0,e.useRef)(null),(0,e.useRef)("");let ak=(0,e.useRef)(""),al=(0,e.useMemo)(()=>{if(u(A))return{addr:m.$.weth,meta:{...t,address:m.$.weth},isNativeEth:!0};if("__custom__"===A&&I&&/^0x[0-9a-fA-F]{40}$/.test(E))return{addr:E,meta:I,isNativeEth:!1};let a=y.find(a=>a.address===A);return a?{addr:a.address,meta:a,isNativeEth:!1}:{addr:"",meta:null,isNativeEth:!1}},[A,E,I,y]),am=(0,e.useMemo)(()=>{if(u(C))return{addr:m.$.weth,meta:{...t,address:m.$.weth},isNativeEth:!0};if("__custom__"===C&&K&&/^0x[0-9a-fA-F]{40}$/.test(G))return{addr:G,meta:K,isNativeEth:!1};let a=y.find(a=>a.address===C);return a?{addr:a.address,meta:a,isNativeEth:!1}:{addr:"",meta:null,isNativeEth:!1}},[C,G,K,y]),an=(0,e.useMemo)(()=>{if(!m.$.weth)return null;let a=al.isNativeEth,b=am.isNativeEth,c=!!al.addr&&v(al.addr),d=!!am.addr&&v(am.addr);return a&&d?{direction:"wrap"}:c&&b?{direction:"unwrap"}:null},[al.addr,al.isNativeEth,am.addr,am.isNativeEth]),ao=(0,e.useRef)(y);ao.current=y;let ap=(0,e.useRef)(ax);ap.current=ax;let aq=(0,e.useRef)(ae);aq.current=ae,(0,p.SL)((0,e.useCallback)(a=>{if("swap"===a.type){let b=ao.current,c=a=>{if(!a)return;let c=a.toUpperCase();if("ETH"===c||"WETH"===c)return t.address;let d=b.find(a=>a.symbol.toUpperCase()===c);return d?.address},d=c(a.tokenIn),e=c(a.tokenOut);d&&B(d),e&&D(e),a.amount&&P(a.amount),a.fee&&N(Number(a.fee)),a.slippage&&X(Number(a.slippage))}else"flip_tokens"===a.type?ap.current():"max_balance"===a.type?aq.current&&P(aq.current):"set_fee"===a.type?N(Number(a.fee)):"set_slippage"===a.type&&X(Number(a.bps))},[]));let ar=(0,e.useCallback)(async()=>{if(an){V(!1);let a=(O||"").trim();if(!a||"0"===a||"0."===a||"."===a){R(0n),T("");return}try{let b=(0,h.X)(a,18);R(b),T(a)}catch{R(0n),T("")}return}if(!m.$.quoterV2||!al.addr||!am.addr||!al.meta||!am.meta)return;let a=(O||"").trim();if(!a||"0"===a||"0."===a||"."===a){R(0n),T("");return}V(!0);try{let b=(0,h.X)(a,al.meta.decimals);if(0n===b){R(0n),T("");return}let c=async a=>(await l.R.readContract({address:m.$.quoterV2,abi:n.D8,functionName:"quoteExactInputSingle",args:[{tokenIn:al.addr,tokenOut:am.addr,amountIn:b,fee:a,sqrtPriceLimitX96:0n}]}))[0],d=[M,...q.map(a=>a.fee).filter(a=>a!==M)],e=null,f=M;for(let a of d)try{let b=await c(a);if(b>0n){e=b,f=a;break}}catch{}if(null===e){R(0n),T("No liquidity");return}R(e),T((0,g.J)(e,am.meta.decimals));let i=`${al.addr.toLowerCase()}|${am.addr.toLowerCase()}|${b.toString()}`;f!==M&&ak.current!==i&&(ak.current=i,N(f))}finally{V(!1)}},[O,M,al.addr,al.meta,am.addr,am.meta,an]),as=(0,e.useMemo)(()=>{if(!O||!S||"No liquidity"===S||!al.meta||!am.meta)return null;let a=Number(O),b=Number(S);return a<=0||b<=0?null:{forward:b/a,inverse:a/b,inSymbol:al.isNativeEth?"ETH":al.meta.symbol,outSymbol:am.isNativeEth?"ETH":am.meta.symbol}},[O,S,al.meta,al.isNativeEth,am.meta,am.isNativeEth]),at=(0,e.useMemo)(()=>Q<=0n?0n:Q*(10000n-BigInt(W))/10000n,[Q,W]);async function au(a,b,d,e,f){if(await l.R.readContract({address:d,abi:n.bx,functionName:"allowance",args:[a,b]})>=e)return;if(_(`Approving ${f}...`),ab("info"),!c)throw Error("No wallet client");let g=await c.writeContract({address:d,abi:n.bx,functionName:"approve",args:[b,e],chain:l.A,account:a});await l.R.waitForTransactionReceipt({hash:g})}async function av(){if(!b){_("Connect wallet to swap."),ab("error");return}if(!m.$.swapRouter||!al.addr||!am.addr||!al.meta||!am.meta){_("Select valid tokens."),ab("error");return}let a=al.isNativeEth?"ETH":al.meta.symbol,d=am.isNativeEth?"ETH":am.meta.symbol;ad(!0),aj("");try{let e,f=(O||"").trim(),g=(0,h.X)(f||"0",al.meta.decimals);if(0n===g)throw Error("Amount must be greater than 0");if(ae){let b=(0,h.X)(ae,al.meta.decimals);if(g>b){_(`Insufficient ${a} balance. You have ${w(ae)} but need ${f}.`),ab("error"),ad(!1);return}}if(_(`Preparing swap: ${f} ${a} → ${d}...`),ab("info"),await k(),!c)throw Error("No wallet client");let j=BigInt(Math.floor(Date.now()/1e3)+600),o=BigInt(Math.max(0,Math.min(3e3,W))),p=0n;try{p=(await l.R.readContract({address:m.$.quoterV2,abi:n.D8,functionName:"quoteExactInputSingle",args:[{tokenIn:al.addr,tokenOut:am.addr,amountIn:g,fee:M,sqrtPriceLimitX96:0n}]}))[0]*(10000n-o)/10000n}catch{_("Could not fetch quote. Pool may not have liquidity for this pair."),ab("error"),ad(!1);return}let q=al.isNativeEth;if(am.isNativeEth){q||await au(b,m.$.swapRouter,al.addr,g,a),_(`Swapping ${f} ${a} → ~${S?w(S):"?"} ${d}...`),ab("info");let h=(0,i.p)({abi:n.zO,functionName:"exactInputSingle",args:[{tokenIn:al.addr,tokenOut:am.addr,fee:M,recipient:m.$.swapRouter,deadline:j,amountIn:g,amountOutMinimum:p,sqrtPriceLimitX96:0n}]}),k=(0,i.p)({abi:n.zO,functionName:"unwrapWETH9",args:[p,b]});e=await c.writeContract({address:m.$.swapRouter,abi:n.zO,functionName:"multicall",args:[[h,k]],value:q?g:0n,chain:l.A,account:b})}else q||await au(b,m.$.swapRouter,al.addr,g,a),_(`Swapping ${f} ${a} → ~${S?w(S):"?"} ${d}...`),ab("info"),e=await c.writeContract({address:m.$.swapRouter,abi:n.zO,functionName:"exactInputSingle",args:[{tokenIn:al.addr,tokenOut:am.addr,fee:M,recipient:b,deadline:j,amountIn:g,amountOutMinimum:p,sqrtPriceLimitX96:0n}],value:q?g:0n,chain:l.A,account:b});aj(e),_("Confirming on-chain..."),ab("info");let r=await l.R.waitForTransactionReceipt({hash:e});"success"===r.status?(_(`Swap confirmed! Received ~${S?w(S):"?"} ${d}`),ab("success"),P("")):(_("Transaction reverted. The price may have moved beyond your slippage tolerance."),ab("error")),ar().catch(()=>{})}catch(b){let a=String(b?.shortMessage||b?.message||b);a.includes("user rejected")||a.includes("User denied")?_("Transaction cancelled by user."):_(`Swap failed: ${a}`),ab("error")}finally{ad(!1)}}async function aw(){if(an){if(!b||!c){_("Connect wallet to wrap."),ab("error");return}if(!m.$.weth){_("Missing WETH address in config."),ab("error");return}ad(!0),aj("");try{let a=(O||"").trim(),d=(0,h.X)(a||"0",18);if(0n===d)throw Error("Amount must be greater than 0");if(await k(),"wrap"===an.direction){_(`Wrapping ${a} ETH → WETH...`),ab("info");let e=await c.writeContract({address:m.$.weth,abi:s,functionName:"deposit",args:[],value:d,chain:l.A,account:b});aj(e),await l.R.waitForTransactionReceipt({hash:e}),_("Wrap confirmed!"),ab("success")}else{_(`Unwrapping ${a} WETH → ETH...`),ab("info");let e=await c.writeContract({address:m.$.weth,abi:s,functionName:"withdraw",args:[d],chain:l.A,account:b});aj(e),await l.R.waitForTransactionReceipt({hash:e}),_("Unwrap confirmed!"),ab("success")}P(""),R(0n),T("")}catch(b){let a=String(b?.shortMessage||b?.message||b);a.includes("user rejected")||a.includes("User denied")?_("Transaction cancelled by user."):_(`Wrap failed: ${a}`),ab("error")}finally{ad(!1)}}}function ax(){B(C),F(G),J(K),D(A),H(E),L(I),P(""),R(0n),T("")}let ay=al.isNativeEth?"ETH":al.meta?.symbol||"",az=am.isNativeEth?"ETH":am.meta?.symbol||"",aA=U?"Quoting...":S&&"No liquidity"!==S?`${w(S)} ${az}`:S,aB=al.addr&&am.addr&&O&&Number(O)>0&&S&&"No liquidity"!==S;(0,e.useMemo)(()=>(!as,null),[as,S]);let aC=!!ae&&!!O&&Number(O)>Number(ae),aD=ac?"Processing...":b?al.addr&&am.addr?!O||0>=Number(O)?"Enter Amount":an?"wrap"===an.direction?"Wrap ETH to WETH":"Unwrap WETH to ETH":"No liquidity"===S?"No Liquidity for This Pair":aC?`Insufficient ${ay} Balance`:`Swap ${ay} for ${az}`:"Select Tokens":"Connect Wallet",aE=an?!O||0>=Number(O)||ac||aC:!aB||ac||aC;return(0,d.jsxs)("div",{className:"lm-swap-card p-1",children:[(0,d.jsx)(x,{tokens:y,value:A,onChange:B,customAddr:E,onCustomAddr:F,customMeta:I,label:"You Pay",balance:ae||void 0,symbol:ay,onMax:()=>{ae&&P(ae)},amount:O,onAmountChange:P,isNativeEth:al.isNativeEth}),(0,d.jsx)("div",{className:"flex justify-center -my-2 relative z-10",children:(0,d.jsx)("button",{type:"button",onClick:ax,disabled:ac,className:"w-10 h-10 flex items-center justify-center bg-lm-terminal-darkgray border-2 border-lm-terminal-gray hover:border-lm-orange hover:bg-lm-black text-lm-terminal-lightgray hover:text-lm-orange group disabled:opacity-40 disabled:pointer-events-none",title:"Flip tokens",children:(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4 group-hover:rotate-180 transition-transform duration-300",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M2.24 6.8a.75.75 0 001.06-.04l1.95-2.1v8.59a.75.75 0 001.5 0V4.66l1.95 2.1a.75.75 0 101.1-1.02l-3.25-3.5a.75.75 0 00-1.1 0L2.2 5.74a.75.75 0 00.04 1.06zm8 6.4a.75.75 0 00-.04 1.06l3.25 3.5a.75.75 0 001.1 0l3.25-3.5a.75.75 0 10-1.1-1.02l-1.95 2.1V6.75a.75.75 0 00-1.5 0v8.59l-1.95-2.1a.75.75 0 00-1.06-.04z",clipRule:"evenodd"})})})}),(0,d.jsx)(x,{tokens:y,value:C,onChange:D,customAddr:G,onCustomAddr:H,customMeta:K,label:"You Receive",balance:ag||void 0,symbol:az,amountReadonly:!0,quoteDisplay:aA,isNativeEth:am.isNativeEth}),(as||aB)&&(0,d.jsxs)("div",{className:"mx-1 mt-2",children:[(0,d.jsxs)("button",{type:"button",onClick:()=>Z(!Y),className:"flex items-center justify-between w-full py-2 px-2 text-[10px] hover:bg-lm-terminal-darkgray/50 transition-colors",children:[(0,d.jsx)("div",{className:"flex items-center gap-2 text-lm-terminal-lightgray",children:as&&(0,d.jsxs)("span",{className:"text-white lm-mono",children:["1 ",as.inSymbol," = ",0===(a=as.forward)||isNaN(a)?"—":a>=1e6?`${(a/1e6).toFixed(2)}M`:a>=1e3?`${(a/1e3).toFixed(2)}K`:a>=1?a.toFixed(4):a>=1e-4?a.toFixed(6):a.toExponential(2)," ",as.outSymbol]})}),(0,d.jsxs)("div",{className:"flex items-center gap-1.5 text-lm-terminal-lightgray",children:[(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"w-3 h-3",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M6.955 1.45A.5.5 0 017.452 1h1.096a.5.5 0 01.497.45l.17 1.699c.484.12.94.312 1.356.562l1.321-.916a.5.5 0 01.67.033l.774.775a.5.5 0 01.033.67l-.916 1.32c.25.417.443.873.563 1.357l1.699.17a.5.5 0 01.45.497v1.096a.5.5 0 01-.45.497l-1.699.17c-.12.484-.312.94-.562 1.356l.916 1.321a.5.5 0 01-.034.67l-.774.774a.5.5 0 01-.67.033l-1.32-.916c-.417.25-.873.443-1.357.563l-.17 1.699a.5.5 0 01-.497.45H7.452a.5.5 0 01-.497-.45l-.17-1.699a4.973 4.973 0 01-1.356-.562l-1.321.916a.5.5 0 01-.67-.034l-.774-.774a.5.5 0 01-.034-.67l.916-1.32a4.973 4.973 0 01-.562-1.357l-1.699-.17A.5.5 0 011 8.548V7.452a.5.5 0 01.45-.497l1.699-.17c.12-.484.312-.94.562-1.356l-.916-1.321a.5.5 0 01.034-.67l.774-.774a.5.5 0 01.67-.033l1.32.916c.417-.25.873-.443 1.357-.563l.17-1.699zM8 10a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:`w-3 h-3 transition-transform ${Y?"rotate-180":""}`,children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M4.22 6.22a.75.75 0 011.06 0L8 8.94l2.72-2.72a.75.75 0 111.06 1.06l-3.25 3.25a.75.75 0 01-1.06 0L4.22 7.28a.75.75 0 010-1.06z",clipRule:"evenodd"})})]})]}),Y&&(0,d.jsxs)("div",{className:"bg-lm-black border border-lm-terminal-gray/50 p-3 space-y-3 mt-1 lm-fade-in",children:[aB&&am.meta&&(0,d.jsxs)("div",{className:"space-y-1.5 text-[10px]",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"Minimum received"}),(0,d.jsxs)("span",{className:"text-white lm-mono font-bold",children:[w((0,g.J)(at,am.meta.decimals))," ",az]})]}),(al.isNativeEth||am.isNativeEth)&&(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"Route"}),(0,d.jsxs)("div",{className:"flex items-center gap-1 text-white lm-mono",children:[(0,d.jsx)("span",{children:ay}),(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"→"}),al.isNativeEth&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"WETH"}),(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"→"})]}),am.isNativeEth&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"WETH"}),(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"→"})]}),(0,d.jsx)("span",{children:az})]})]}),(0,d.jsx)("div",{className:"h-px bg-lm-terminal-gray/30 my-1"})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-[10px] lm-upper font-bold tracking-wider",children:"Fee Tier"}),(0,d.jsx)("div",{className:"flex gap-1",children:q.map(a=>(0,d.jsxs)("button",{type:"button",onClick:()=>N(a.fee),className:`flex-1 py-2 border text-center ${M===a.fee?"border-lm-orange text-lm-orange bg-lm-orange/5":"border-lm-terminal-gray text-lm-gray hover:border-lm-gray"}`,children:[(0,d.jsx)("div",{className:"text-xs font-bold",children:a.label}),(0,d.jsx)("div",{className:"text-[9px] opacity-60",children:a.hint})]},a.fee))})]}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-[10px] lm-upper font-bold tracking-wider",children:"Max Slippage"}),(0,d.jsx)("div",{className:"flex gap-1",children:r.map(a=>(0,d.jsx)("button",{type:"button",onClick:()=>X(a.bps),className:`flex-1 text-xs py-2 border ${W===a.bps?"border-lm-orange text-lm-orange bg-lm-orange/5":"border-lm-terminal-gray text-lm-gray hover:border-lm-gray"}`,children:a.label},a.bps))}),(0,d.jsx)("div",{className:"text-[9px] text-lm-terminal-lightgray",children:"Swap reverts if price moves beyond this tolerance."})]})]})]}),aC&&(0,d.jsxs)("div",{className:"mx-1 mt-1.5 lm-callout lm-callout-red text-[10px] flex items-center gap-2",children:[(0,d.jsx)("span",{className:"lm-dot lm-dot-red"}),(0,d.jsxs)("span",{children:["Insufficient balance. You have ",(0,d.jsx)("span",{className:"text-white font-bold",children:w(ae)})," ",ay," but need ",(0,d.jsx)("span",{className:"text-white font-bold",children:O}),"."]})]}),(0,d.jsx)("div",{className:"p-1 pt-2",children:(0,d.jsx)(j.$,{onClick:an?aw:av,loading:ac,disabled:aE,variant:aE?"default":"primary",size:"lg",className:`w-full ${!aE?"bg-lm-orange text-black":""}`,children:aD})}),$&&(0,d.jsxs)("div",{className:`mx-1 mb-1 text-xs p-2.5 border bg-lm-black flex items-center justify-between gap-2 ${"success"===aa?"text-lm-green":"error"===aa?"text-lm-red":"text-lm-gray"} ${"success"===aa?"border-lm-green/20":"error"===aa?"border-lm-red/20":"border-lm-terminal-gray"}`,children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:["info"===aa&&(0,d.jsx)("span",{className:"lm-spinner flex-shrink-0",style:{width:12,height:12,borderWidth:1.5}}),"success"===aa&&(0,d.jsx)("span",{className:"lm-dot lm-dot-green flex-shrink-0"}),"error"===aa&&(0,d.jsx)("span",{className:"lm-dot lm-dot-red flex-shrink-0"}),(0,d.jsx)("span",{className:"truncate",children:$})]}),ai&&(0,d.jsx)("a",{href:`${m.$.blockExplorerUrl||"https://explorer.testnet.chain.robinhood.com"}/tx/${ai}`,target:"_blank",rel:"noreferrer",className:"text-lm-orange hover:underline text-[10px] flex-shrink-0",children:"View Tx →"})]})]})}},53058:(a,b,c)=>{"use strict";c.d(b,{PoolsPanel:()=>F});var d=c(21124),e=c(38301),f=c(29808),g=c(79426),h=c(20596),i=c(85258),j=c(69656);c(93992);var k=c(85365),l=c(39632),m=c(20003),n=c(66335),o=c(16140);let p=[{label:"0.05%",fee:500,tickSpacing:10,hint:"Stables"},{label:"0.30%",fee:3e3,tickSpacing:60,hint:"Standard"},{label:"1.00%",fee:1e4,tickSpacing:200,hint:"Volatile"}],q=[{label:"0.5%",bps:50},{label:"1%",bps:100},{label:"3%",bps:300}],r={address:"0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",symbol:"ETH",decimals:18,logoURI:""};function s(a){return a.toLowerCase()===r.address.toLowerCase()}let t=2n**160n-1n;function u(a,b){return Math.max(Math.ceil(-887272/b)*b,Math.min(Math.floor(887272/b)*b,a))}function v(a,b,c){return Math.pow(1.0001,a)*Math.pow(10,b-c)}function w(a){return 0!==a&&Number.isFinite(a)?a>=1e6?`${(a/1e6).toFixed(2)}M`:a>=1e3?`${(a/1e3).toFixed(2)}K`:a>=1?a.toFixed(4):a>=1e-4?a.toFixed(6):a>=1e-7?a.toFixed(10):a.toExponential(2):"—"}function x(a){return a<=0?1n:10n**BigInt(a)}function y(a){if(a<-887272||a>887272)throw Error("tick out of range");let b=a<0?-a:a,c=(1&b)!=0?0xfffcb933bd6fad37aa2d162d1a594001n:0x100000000000000000000000000000000n;(2&b)!=0&&(c=0xfff97272373d413259a46990580e213an*c>>128n),(4&b)!=0&&(c=0xfff2e50f5f656932ef12357cf3c7fdccn*c>>128n),(8&b)!=0&&(c=0xffe5caca7e10e4e61c3624eaa0941cd0n*c>>128n),(16&b)!=0&&(c=0xffcb9843d60f6159c9db58835c926644n*c>>128n),(32&b)!=0&&(c=0xff973b41fa98c081472e6896dfb254c0n*c>>128n),(64&b)!=0&&(c=0xff2ea16466c96a3843ec78b326b52861n*c>>128n),(128&b)!=0&&(c=0xfe5dee046a99a2a811c461f1969c3053n*c>>128n),(256&b)!=0&&(c=0xfcbe86c7900a88aedcffc83b479aa3a4n*c>>128n),(512&b)!=0&&(c=0xf987a7253ac413176f2b074cf7815e54n*c>>128n),(1024&b)!=0&&(c=0xf3392b0822b70005940c7a398e4b70f3n*c>>128n),(2048&b)!=0&&(c=0xe7159475a2c29b7443b29c7fa6e889d9n*c>>128n),(4096&b)!=0&&(c=0xd097f3bdfd2022b8845ad8f792aa5825n*c>>128n),(8192&b)!=0&&(c=0xa9f746462d870fdf8a65dc1f90e061e5n*c>>128n),(16384&b)!=0&&(c=0x70d869a156d2a1b890bb3df62baf32f7n*c>>128n),(32768&b)!=0&&(c=0x31be135f97d08fd981231505542fcfa6n*c>>128n),(65536&b)!=0&&(c=0x9aa508b5b7a84e1c677de54f3e99bc9n*c>>128n),(131072&b)!=0&&(c=0x5d6af8dedb81196699c329225ee604n*c>>128n),(262144&b)!=0&&(c=0x2216e584f5fa1ea926041bedfe98n*c>>128n),(524288&b)!=0&&(c=0x48a170391f7dc42444e8fa2n*c>>128n),a>0&&(c=((1n<<256n)-1n)/c);let d=(c&(1n<<32n)-1n)!==0n;return(c>>32n)+(d?1n:0n)}function z(a,b,c){if(0n===c)throw Error("div by zero");return a*b/c}function A(a,b,c){return a>b&&([a,b]=[b,a]),z(c,z(a,b,2n**96n),b-a)}function B(a,b,c){return a>b&&([a,b]=[b,a]),z(c,2n**96n,b-a)}function C(a,b,c,d){let e=2n**96n;return(b>c&&([b,c]=[c,b]),a<=b)?{amount0:z(d,(c-b)*e,b*c),amount1:0n}:a<c?{amount0:z(d,(c-a)*e,a*c),amount1:z(d,a-b,e)}:{amount0:0n,amount1:z(d,c-b,e)}}function D({mode:a,lower:b,upper:c,current:e,quoteLabel:f}){if(!e||!Number.isFinite(e)||e<=0)return null;let g=106;if("full"===a||!b||!c||!Number.isFinite(b)||!Number.isFinite(c)||b<=0||c<=0||b>=c)return(0,d.jsxs)("div",{className:"bg-lm-black border border-lm-terminal-gray p-2 space-y-1 text-[10px]",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray lm-upper font-bold tracking-wider",children:"Range"}),(0,d.jsx)("span",{className:"lm-badge lm-badge-gray",children:"Full Range"})]}),(0,d.jsxs)("svg",{viewBox:"0 0 520 140",className:"w-full h-[140px] border border-lm-terminal-gray bg-lm-terminal-darkgray",children:[(0,d.jsx)("rect",{x:"0",y:"0",width:520,height:140,fill:"transparent"}),(0,d.jsx)("line",{x1:44,y1:g,x2:504,y2:g,stroke:"rgba(255,255,255,0.12)",strokeWidth:"1"}),(0,d.jsx)("line",{x1:44,y1:16,x2:504,y2:16,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),(0,d.jsx)("line",{x1:44,y1:61,x2:504,y2:61,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),(0,d.jsx)("line",{x1:159,y1:16,x2:159,y2:g,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),(0,d.jsx)("line",{x1:274,y1:16,x2:274,y2:g,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),(0,d.jsx)("line",{x1:389,y1:16,x2:389,y2:g,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),(0,d.jsx)("path",{d:`M 44 ${g} C ${159} ${25}, ${389} ${25}, ${504} ${g}`,fill:"rgba(207,255,4,0.10)",stroke:"rgba(207,255,4,0.35)",strokeWidth:"2"}),(0,d.jsx)("line",{x1:274,y1:16,x2:274,y2:g+2,stroke:"rgba(255,255,255,0.9)",strokeWidth:"2"}),(0,d.jsx)("text",{x:44,y:128,fill:"rgba(255,255,255,0.6)",fontSize:"11",children:"0"}),(0,d.jsxs)("text",{x:274,y:128,fill:"rgba(255,255,255,0.9)",fontSize:"11",textAnchor:"middle",className:"lm-mono",children:[w(e)," ",f]}),(0,d.jsx)("text",{x:504,y:128,fill:"rgba(255,255,255,0.6)",fontSize:"11",textAnchor:"end",children:"∞"})]})]});let h=e>=b&&e<=c,i=Math.log(b),j=Math.log(c),k=Math.log(e),l=a=>Math.max(0,Math.min(1,(a-i)/(j-i))),m=44+460*l(k),n=l(k),o=[];for(let a=0;a<=60;a++){let b=a/60,c=g-76.5*Math.exp(-Math.pow((b-n)/.18,2));o.push([44+460*b,c])}let p=`M 44 ${g} L ${o.map(([a,b])=>`${a.toFixed(2)} ${b.toFixed(2)}`).join(" L ")} L ${504} ${g} Z`;return(0,d.jsxs)("div",{className:"bg-lm-black border border-lm-terminal-gray p-2 space-y-1 text-[10px]",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray lm-upper font-bold tracking-wider",children:"Range"}),(0,d.jsx)("span",{className:h?"lm-badge lm-badge-green":"lm-badge lm-badge-orange",children:h?"In Range":"Out of Range"})]}),(0,d.jsxs)("svg",{viewBox:"0 0 520 140",className:"w-full h-[140px] border border-lm-terminal-gray bg-lm-terminal-darkgray",children:[(0,d.jsx)("rect",{x:"0",y:"0",width:520,height:140,fill:"transparent"}),(0,d.jsx)("line",{x1:44,y1:g,x2:504,y2:g,stroke:"rgba(255,255,255,0.12)",strokeWidth:"1"}),(0,d.jsx)("line",{x1:44,y1:16,x2:504,y2:16,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),(0,d.jsx)("line",{x1:44,y1:61,x2:504,y2:61,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),(0,d.jsx)("line",{x1:159,y1:16,x2:159,y2:g,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),(0,d.jsx)("line",{x1:274,y1:16,x2:274,y2:g,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),(0,d.jsx)("line",{x1:389,y1:16,x2:389,y2:g,stroke:"rgba(255,255,255,0.06)",strokeWidth:"1"}),(0,d.jsx)("rect",{x:44,y:16,width:460,height:90,fill:"rgba(0,0,0,0.15)"}),(0,d.jsx)("rect",{x:44,y:16,width:460,height:90,fill:h?"rgba(0,255,0,0.10)":"rgba(207,255,4,0.08)"}),(0,d.jsx)("path",{d:p,fill:"rgba(255,255,255,0.06)"}),(0,d.jsx)("path",{d:p.replace("Z",""),fill:"none",stroke:"rgba(255,255,255,0.28)",strokeWidth:"2"}),(0,d.jsx)("line",{x1:m,y1:16,x2:m,y2:g+2,stroke:"rgba(255,255,255,0.9)",strokeWidth:"2"}),(0,d.jsx)("text",{x:44,y:128,fill:"rgba(255,255,255,0.65)",fontSize:"11",className:"lm-mono",children:w(b)}),(0,d.jsx)("text",{x:m,y:128,fill:"rgba(255,255,255,0.95)",fontSize:"11",textAnchor:"middle",className:"lm-mono",children:w(e)}),(0,d.jsx)("text",{x:504,y:128,fill:"rgba(255,255,255,0.65)",fontSize:"11",textAnchor:"end",className:"lm-mono",children:w(c)}),(0,d.jsx)("text",{x:504,y:14,fill:"rgba(255,255,255,0.45)",fontSize:"10",textAnchor:"end",children:f})]})]})}function E(a){let b=Number(a);return isNaN(b)||0===b?"0":b>=1e6?`${(b/1e6).toFixed(2)}M`:b>=1e3?`${(b/1e3).toFixed(2)}K`:b>=1?b.toFixed(4):b>=1e-4?b.toFixed(6):b.toExponential(2)}function F(){let{address:a,walletClient:b,requireCorrectChain:c,connect:z}=(0,n.v)(),[F,G]=(0,e.useState)([]),[H,I]=(0,e.useState)(""),[J,K]=(0,e.useState)(""),[L,M]=(0,e.useState)(3e3),[N,O]=(0,e.useState)(""),[P,Q]=(0,e.useState)(!1),[R,S]=(0,e.useState)(""),[T,U]=(0,e.useState)(""),[V,W]=(0,e.useState)(""),[X,Y]=(0,e.useState)(!0),[Z,$]=(0,e.useState)("amt0"),[_,aa]=(0,e.useState)(""),[ab,ac]=(0,e.useState)(100),[ad,ae]=(0,e.useState)("full"),[af,ag]=(0,e.useState)(""),[ah,ai]=(0,e.useState)(""),[aj,ak]=(0,e.useState)(""),[al,am]=(0,e.useState)("info"),[an,ao]=(0,e.useState)(!1),[ap,aq]=(0,e.useState)(""),[ar,as]=(0,e.useState)(""),at=(0,e.useMemo)(()=>[r,...F],[F]),au=(0,e.useMemo)(()=>{if(!H)return{selector:"",addr:"",meta:null,isNativeEth:!1};if(s(H))return k.$.weth?{selector:H,addr:k.$.weth,meta:{...r,address:k.$.weth},isNativeEth:!0}:{selector:H,addr:"",meta:null,isNativeEth:!0};let a=F.find(a=>a.address.toLowerCase()===H.toLowerCase());return a?{selector:H,addr:a.address,meta:a,isNativeEth:!1}:{selector:H,addr:"",meta:null,isNativeEth:!1}},[H,F]),av=(0,e.useMemo)(()=>{if(!J)return{selector:"",addr:"",meta:null,isNativeEth:!1};if(s(J))return k.$.weth?{selector:J,addr:k.$.weth,meta:{...r,address:k.$.weth},isNativeEth:!0}:{selector:J,addr:"",meta:null,isNativeEth:!0};let a=F.find(a=>a.address.toLowerCase()===J.toLowerCase());return a?{selector:J,addr:a.address,meta:a,isNativeEth:!1}:{selector:J,addr:"",meta:null,isNativeEth:!1}},[J,F]),aw=au.meta,ax=av.meta,ay=(0,e.useMemo)(()=>p.find(a=>a.fee===L),[L]),az=(0,e.useMemo)(()=>au.addr&&av.addr&&au.addr.toLowerCase()!==av.addr.toLowerCase()?{token0:au.addr.toLowerCase()<av.addr.toLowerCase()?au.addr:av.addr,token1:au.addr.toLowerCase()<av.addr.toLowerCase()?av.addr:au.addr}:null,[au.addr,av.addr]),aA=(0,e.useMemo)(()=>{if(az)return(au.addr.toLowerCase()===az.token0.toLowerCase()?au.meta:av.meta)||F.find(a=>a.address.toLowerCase()===az.token0.toLowerCase())},[az,au.addr,au.meta,av.meta,F]),aB=(0,e.useMemo)(()=>{if(az)return(au.addr.toLowerCase()===az.token1.toLowerCase()?au.meta:av.meta)||F.find(a=>a.address.toLowerCase()===az.token1.toLowerCase())},[az,au.addr,au.meta,av.meta,F]),aC=(0,e.useMemo)(()=>{try{var a,b;if(!az||!aA||!aB)return"";let c=(N||"").trim();if(!c||"0"===c)return"";let d=(0,g.X)(c,18);if(d<=0n)return"";let e=(a=aA.decimals,(b=aB.decimals)>a?d*x(b-a):a>b?d/x(a-b):d);if(e<=0n)return"";let f=2n**96n,h=f*f*e/10n**18n;if(h<=0n)return"";let i=function(a){if(a<0n)throw Error("sqrt of negative");if(a<2n)return a;let b=a,c=b+1n>>1n;for(;c<b;)b=c,c=c+a/c>>1n;return b}(h);if(i<=0n||i>t)return"";return i.toString()}catch{return""}},[N,aA,aB,az]),aD=(0,e.useMemo)(()=>R.trim()?R.trim():aC,[aC,R]),[aE,aF]=(0,e.useState)(""),[aG,aH]=(0,e.useState)(null),[aI,aJ]=(0,e.useState)(null),[aK,aL]=(0,e.useState)(""),aM=(0,e.useCallback)(async()=>{if(!k.$.uniFactory||!az||!ay||!aA||!aB){aF(""),aH(null),aJ(null),aL("");return}try{let a=await m.R.readContract({address:k.$.uniFactory,abi:l.HB,functionName:"getPool",args:[az.token0,az.token1,L]});if(!a||"0x0000000000000000000000000000000000000000"===a){aF(""),aH(null),aJ(null),aL("");return}aF(a);let b=await m.R.readContract({address:a,abi:l.ld,functionName:"slot0"}),c=b[0],d=b[1];aJ(c),aH(d);let e={num:c*c,den:2n**192n},f=BigInt(aA.decimals),g=BigInt(aB.decimals),h=e.num,i=e.den;f>g&&(h*=10n**(f-g)),g>f&&(i*=10n**(g-f)),aL(function(a,b,c=6){if(0n===b)return"0";let d=10n**BigInt(c),e=(a*d/b).toString().padStart(c+1,"0"),f=e.slice(0,-c),g=e.slice(-c);return`${f}.${g}`.replace(/\.?0+$/,a=>"")}(h,i,8))}catch{aF(""),aH(null),aJ(null),aL("")}},[L,ay,aA,aB,az]),aN=(0,e.useMemo)(()=>{var a,b,c;if(!ay)return{ticks:null,error:""};if("full"===ad){return{ticks:{tickLower:Math.ceil(-887272/(c=ay.tickSpacing))*c,tickUpper:Math.floor(887272/c)*c},error:""}}if(!aA||!aB)return{ticks:null,error:"Select tokens first."};let d=(af||"").trim(),e=(ah||"").trim();if(!d||!e)return{ticks:null,error:""};let f=Number(d),g=Number(e);if(!Number.isFinite(f)||!Number.isFinite(g))return{ticks:null,error:"Enter valid numbers for min/max price."};if(f<=0||g<=0)return{ticks:null,error:"Min/max price must be greater than 0."};if(f>=g)return{ticks:null,error:"Min price must be lower than max price."};let h=Math.pow(10,aB.decimals-aA.decimals);if(!Number.isFinite(h)||h<=0)return{ticks:null,error:"Price scaling overflow. Try a smaller range."};let i=f*h,j=g*h;if(!Number.isFinite(i)||!Number.isFinite(j)||i<=0||j<=0)return{ticks:null,error:"Price range is too large/small to compute ticks."};let k=Math.log(1.0001),l=Math.log(i)/k,m=Math.log(j)/k;if(!Number.isFinite(l)||!Number.isFinite(m))return{ticks:null,error:"Price range is out of tick bounds."};let n=Math.floor(m),o=u(Math.floor(Math.floor(l)/(a=ay.tickSpacing))*a,a),p=u(Math.ceil(n/(b=ay.tickSpacing))*b,b);return Number.isFinite(o)&&Number.isFinite(p)?o>=p?{ticks:null,error:"Range too narrow for this fee tier. Widen the range."}:{ticks:{tickLower:o,tickUpper:p},error:""}:{ticks:null,error:"Invalid tick calculation."}},[ay,ah,af,ad,aA,aB]),aO=aN.ticks,aP=aN.error,aQ=(0,e.useMemo)(()=>aO&&aA&&aB?{lower:v(aO.tickLower,aA.decimals,aB.decimals),upper:v(aO.tickUpper,aA.decimals,aB.decimals)}:null,[aO,aA,aB]),aR=(0,e.useMemo)(()=>{try{if(null!==aG&&aA&&aB){let a=v(aG,aA.decimals,aB.decimals);return Number.isFinite(a)&&a>0?a:null}let a=Number((N||"").trim());return Number.isFinite(a)&&a>0?a:null}catch{return null}},[aG,N,aA,aB]),aS=(0,e.useMemo)(()=>{if(aE&&aI)return aI;try{let a=BigInt((aD||"").trim()||"0");if(a<=0n||a>t)return null;return a}catch{return null}},[aI,aE,aD]),aT=(0,e.useMemo)(()=>{if(!aO||!aw||!ax||!aA||!aB||!aS)return null;try{let a,b,c=y(aO.tickLower),d=y(aO.tickUpper),e=(0,g.X)(T||"0",aw.decimals),f=(0,g.X)(V||"0",ax.decimals);if(0n===e&&0n===f)return{used0:0n,used1:0n,desired0:0n,desired1:0n,leftover0:0n,leftover1:0n,mode:"unknown",note:"Enter amounts to see preview."};if(!az)return null;let h=az.token0.toLowerCase()===au.addr.toLowerCase()?e:f,i=az.token0.toLowerCase()===au.addr.toLowerCase()?f:e,j=c<d?c:d,k=c>d?c:d;if(aS<=j)b="below",a=A(c,d,h);else if(aS>=k)b="above",a=B(c,d,i);else{b="in";let e=A(aS,d,h),f=B(c,aS,i);a=e<f?e:f}let{amount0:l,amount1:m}=C(aS,c,d,a),n=h>l?h-l:0n,o=i>m?i-m:0n;return{used0:l,used1:m,desired0:h,desired1:i,leftover0:n,leftover1:o,mode:b,note:""}}catch(a){return{used0:0n,used1:0n,desired0:0n,desired1:0n,leftover0:0n,leftover1:0n,mode:"unknown",note:String(a?.message||a)}}},[T,V,aS,aO,aA,aB,az,aw,ax,au.addr]),aU=(0,e.useRef)(F);async function aV(a,c,d,e){if(await m.R.readContract({address:d,abi:l.bx,functionName:"allowance",args:[a,c]})>=e)return;if(ak(`Approving ${F.find(a=>a.address===d)?.symbol||"token"}...`),am("info"),!b)throw Error("No wallet client");let f=await b.writeContract({address:d,abi:l.bx,functionName:"approve",args:[c,e],chain:m.A,account:a});await m.R.waitForTransactionReceipt({hash:f})}async function aW(){if(!a){ak("Connect wallet."),am("error");return}if(!k.$.positionManager||!az)return;let d=aw?.symbol||"Token0",e=ax?.symbol||"Token1";ao(!0);try{let f;await c();try{f=BigInt((aD||"").trim()||"0")}catch{throw Error("Initial price is invalid. Enter a valid number.")}if(f<=0n)throw Error("Set an initial price first (enter a price in the field above).");if(f>t)throw Error("Initial price is out of range. Try a smaller price.");if(!b)throw Error("No wallet client");ak(`Creating ${d}/${e} pool (${ay?.label} fee)...`),am("info");let g=await b.writeContract({address:k.$.positionManager,abi:l.g4,functionName:"createAndInitializePoolIfNecessary",args:[az.token0,az.token1,L,f],value:0n,chain:m.A,account:a});ak("Confirming pool creation on-chain...");let h=await m.R.waitForTransactionReceipt({hash:g});"success"===h.status?(ak(`Pool created! ${d}/${e} (${ay?.label}) is now live.`),am("success")):(ak("Pool creation reverted. The pool may already exist for this pair + fee tier."),am("error"))}catch(b){let a=String(b?.shortMessage||b?.message||b);a.includes("user rejected")||a.includes("User denied")?ak("Transaction cancelled."):ak(`Create pool failed: ${a}`),am("error")}finally{ao(!1)}}async function aX(){if(!a){ak("Connect wallet."),am("error");return}if(k.$.positionManager&&au.addr&&av.addr&&aw&&ax&&ay&&az){if(!aO){ak("Invalid price range."),am("error");return}ao(!0);try{let d;await c();let e=(0,g.X)(T||"0",aw.decimals),f=(0,g.X)(V||"0",ax.decimals);if(0n===e&&0n===f)throw Error("Enter amount for at least one token");if(!b)throw Error("No wallet client");let{tickLower:i,tickUpper:j}=aO,n=az.token0.toLowerCase()===au.addr.toLowerCase()?e:f,o=az.token0.toLowerCase()===au.addr.toLowerCase()?f:e;if(!aS){if(!aE)throw Error("No pool found. Set an initial price and create the pool first.");throw Error("Loading pool price. Try again in a moment.")}let p=y(i),q=y(j);if(aS<=(p<q?p:q))d=A(p,q,n);else if(aS>=(p>q?p:q))d=B(p,q,o);else{let a=A(aS,q,n),b=B(p,aS,o);d=a<b?a:b}let r=C(aS,p,q,d),s=BigInt(Math.max(0,Math.min(3e3,ab))),u=r.amount0*(10000n-s)/10000n,v=r.amount1*(10000n-s)/10000n,w=BigInt(Math.floor(Date.now()/1e3)+600),x=(()=>{let a=au.isNativeEth,b=av.isNativeEth;return a&&au.addr.toLowerCase()===az.token0.toLowerCase()?n:a&&au.addr.toLowerCase()===az.token1.toLowerCase()?o:b&&av.addr.toLowerCase()===az.token0.toLowerCase()?n:b&&av.addr.toLowerCase()===az.token1.toLowerCase()?o:0n})();if(au.isNativeEth||await aV(a,k.$.positionManager,au.addr,e),av.isNativeEth||await aV(a,k.$.positionManager,av.addr,f),aE){ak(`Minting LP: ${T||"0"} ${aw.symbol} + ${V||"0"} ${ax.symbol}...`),am("info");let c=(0,h.p)({abi:l.g4,functionName:"mint",args:[{token0:az.token0,token1:az.token1,fee:L,tickLower:i,tickUpper:j,amount0Desired:n,amount1Desired:o,amount0Min:u,amount1Min:v,recipient:a,deadline:w}]}),d=x>0n?[c,(0,h.p)({abi:l.g4,functionName:"refundETH",args:[]})]:[c],e=await b.writeContract({address:k.$.positionManager,abi:l.g4,functionName:"multicall",args:[d],value:x,chain:m.A,account:a});ak("Confirming on-chain...");let f=await m.R.waitForTransactionReceipt({hash:e});"success"===f.status?(ak(`LP position minted! ${aw.symbol}/${ax.symbol} liquidity added. Check the Positions tab.`),am("success")):(ak("Mint transaction reverted. Check your balances and price range."),am("error"))}else{let c;try{c=BigInt((aD||"").trim()||"0")}catch{throw Error("Set an initial price to create the pool first.")}if(c<=0n||c>t)throw Error("Initial price is invalid (sqrtPriceX96 out of range).");ak("Creating pool + minting LP..."),am("info");let d=(0,h.p)({abi:l.g4,functionName:"createAndInitializePoolIfNecessary",args:[az.token0,az.token1,L,c]}),e=(0,h.p)({abi:l.g4,functionName:"mint",args:[{token0:az.token0,token1:az.token1,fee:L,tickLower:i,tickUpper:j,amount0Desired:n,amount1Desired:o,amount0Min:u,amount1Min:v,recipient:a,deadline:w}]}),f=x>0n?[d,e,(0,h.p)({abi:l.g4,functionName:"refundETH",args:[]})]:[d,e],g=await b.writeContract({address:k.$.positionManager,abi:l.g4,functionName:"multicall",args:[f],value:x,chain:m.A,account:a});ak("Confirming on-chain...");let p=await m.R.waitForTransactionReceipt({hash:g});"success"===p.status?(ak("Pool created and LP position minted! Check the Positions tab."),am("success"),await aM()):(ak("Transaction reverted. Check your balances, range, and initial price."),am("error"))}}catch(b){let a=String(b?.shortMessage||b?.message||b);a.includes("user rejected")||a.includes("User denied")?ak("Transaction cancelled."):ak(`Add liquidity failed: ${a}`),am("error")}finally{ao(!1)}}}aU.current=F,(0,o.SL)((0,e.useCallback)(a=>{if("add_liquidity"!==a.type&&"create_pool"!==a.type)return;let b=aU.current,c=a=>{if(!a)return"";let c=a.toUpperCase();if("ETH"===c)return r.address;if("WETH"===c&&k.$.weth)return k.$.weth;let d=b.find(a=>a.symbol.toUpperCase()===c);return d?.address||""},d=c(a.token0),e=c(a.token1);d&&I(d),e&&K(e),a.fee&&M(Number(a.fee)),"create_pool"===a.type&&a.price&&O(a.price),"add_liquidity"===a.type&&("full"===a.range?ae("full"):"custom"===a.range&&(ae("custom"),a.minPrice&&ag(a.minPrice),a.maxPrice&&ai(a.maxPrice)),a.amount0&&U(a.amount0),a.amount1&&W(a.amount1))},[]));let aY=au.addr&&av.addr&&au.addr.toLowerCase()===av.addr.toLowerCase();return(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"bg-lm-terminal-darkgray border border-lm-terminal-gray p-3 space-y-3",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-[10px] lm-upper font-bold tracking-wider",children:"Select Token Pair"}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-xs",children:"Token A"}),(0,d.jsxs)("select",{className:"w-full bg-lm-black border border-lm-terminal-gray hover:border-lm-orange p-2 text-sm h-9 text-white font-bold transition-colors disabled:opacity-40",value:H,onChange:a=>I(a.target.value),disabled:an,children:[0===F.length&&(0,d.jsx)("option",{value:"",disabled:!0,children:"Loading tokens..."}),at.map(a=>(0,d.jsx)("option",{value:a.address,children:a.symbol},a.address))]}),ap&&(0,d.jsxs)("div",{className:"text-[10px] text-lm-terminal-lightgray lm-mono",children:["Balance: ",(0,d.jsx)("span",{className:"text-white",children:E(ap)})]}),au.isNativeEth&&(0,d.jsx)("div",{className:"text-[9px] text-lm-terminal-lightgray",children:"Uses native ETH; wraps to WETH inside the position manager"})]}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-xs",children:"Token B"}),(0,d.jsxs)("select",{className:"w-full bg-lm-black border border-lm-terminal-gray hover:border-lm-orange p-2 text-sm h-9 text-white font-bold transition-colors disabled:opacity-40",value:J,onChange:a=>K(a.target.value),disabled:an,children:[0===F.length&&(0,d.jsx)("option",{value:"",disabled:!0,children:"Loading tokens..."}),at.map(a=>(0,d.jsx)("option",{value:a.address,children:a.symbol},a.address))]}),ar&&(0,d.jsxs)("div",{className:"text-[10px] text-lm-terminal-lightgray lm-mono",children:["Balance: ",(0,d.jsx)("span",{className:"text-white",children:E(ar)})]}),av.isNativeEth&&(0,d.jsx)("div",{className:"text-[9px] text-lm-terminal-lightgray",children:"Uses native ETH; wraps to WETH inside the position manager"})]})]}),aY&&(0,d.jsx)("div",{className:"text-lm-red text-xs",children:"Tokens must be different."}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-[10px] lm-upper font-bold tracking-wider",children:"Trading Fee"}),(0,d.jsx)("div",{className:"flex gap-1",children:p.map(a=>(0,d.jsxs)("button",{type:"button",onClick:()=>M(a.fee),className:`flex-1 py-2 border transition-colors text-center ${L===a.fee?"border-lm-orange text-lm-orange bg-lm-orange/5":"border-lm-terminal-gray text-lm-gray hover:border-lm-gray"}`,children:[(0,d.jsx)("div",{className:"text-xs font-bold",children:a.label}),(0,d.jsx)("div",{className:"text-[9px] opacity-60",children:a.hint})]},a.fee))})]}),az&&(0,d.jsxs)("div",{className:`text-xs bg-lm-black border p-3 space-y-1 ${aE?"border-lm-green/20":"border-lm-red/20"}`,children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:`lm-dot ${aE?"lm-dot-green lm-dot-pulse":"lm-dot-red"}`}),(0,d.jsx)("span",{className:aE?"text-lm-green font-bold":"text-lm-red",children:aE?"Pool Active":"No Pool Found"})]}),aE&&(0,d.jsxs)("a",{href:`${k.$.blockExplorerUrl||"https://explorer.testnet.chain.robinhood.com"}/address/${aE}`,target:"_blank",rel:"noreferrer",className:"text-lm-orange hover:underline lm-mono text-[10px]",children:[aE.slice(0,6)+"..."+aE.slice(-4)," →"]})]}),aK&&aA&&aB&&(0,d.jsxs)("div",{className:"text-[10px] lm-mono flex items-center gap-1.5 pt-0.5",children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"Current Price:"}),(0,d.jsx)("span",{className:"text-white font-bold",children:aK}),(0,d.jsxs)("span",{className:"text-lm-terminal-lightgray",children:[aB.symbol,"/",aA.symbol]})]})]})]}),az&&!aE&&(0,d.jsxs)("div",{className:"bg-lm-terminal-darkgray border border-lm-terminal-gray p-3 space-y-3",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-[10px] lm-upper font-bold tracking-wider",children:"Initialize New Pool"}),(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-[10px]",children:"This pair has no pool yet. Set an initial price to create one."}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"text-lm-terminal-lightgray text-xs",children:["Initial Price (",aB?.symbol||"B"," per ",aA?.symbol||"A",")"]}),(0,d.jsx)(j.p,{value:N,onValueChange:O,placeholder:"e.g. 0.001"}),(N||"").trim()&&!aD?(0,d.jsx)("div",{className:"text-lm-red text-[10px]",children:"Invalid initial price. Enter a positive number."}):null]}),(0,d.jsx)("button",{type:"button",onClick:()=>Q(!P),className:"text-lm-terminal-lightgray text-[10px] hover:text-lm-orange transition-colors",children:P?"▾ Hide developer settings":"▸ Developer settings"}),P&&(0,d.jsxs)("div",{className:"space-y-1 text-[10px]",children:[(0,d.jsxs)("div",{className:"text-lm-terminal-lightgray",children:["sqrtPriceX96 (auto: ",(0,d.jsx)("span",{className:"lm-mono text-lm-gray",children:aC||"—"}),")"]}),(0,d.jsx)(j.p,{value:R,onValueChange:S,placeholder:"Leave blank for auto",className:"text-left text-xs",numeric:!1})]}),(0,d.jsx)(i.$,{onClick:a?aW:z,loading:an,disabled:an||!!a&&!aD,variant:"primary",size:"lg",className:"w-full",children:an?"Creating Pool...":a?"Create Pool":"Connect Wallet"})]}),(0,d.jsxs)("div",{className:"bg-lm-terminal-darkgray border border-lm-terminal-gray p-3 space-y-3",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-[10px] lm-upper font-bold tracking-wider",children:"Add Liquidity"}),aE?null:(0,d.jsx)("div",{className:"text-[10px] text-lm-terminal-lightgray",children:"No pool found for this pair + fee. Set an initial price above and we'll create + initialize + mint in one transaction."}),(0,d.jsxs)("div",{className:"space-y-1.5",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-xs",children:"Price Range"}),(0,d.jsxs)("div",{className:"flex gap-1",children:[(0,d.jsxs)("button",{type:"button",onClick:()=>ae("full"),className:`flex-1 text-xs py-2 border transition-colors ${"full"===ad?"border-lm-orange text-lm-orange bg-lm-orange/5":"border-lm-terminal-gray text-lm-gray hover:border-lm-gray"}`,children:[(0,d.jsx)("div",{className:"font-bold",children:"Full Range"}),(0,d.jsx)("div",{className:"text-[9px] opacity-60",children:"Earn fees at any price"})]}),(0,d.jsxs)("button",{type:"button",onClick:()=>ae("custom"),className:`flex-1 text-xs py-2 border transition-colors ${"custom"===ad?"border-lm-orange text-lm-orange bg-lm-orange/5":"border-lm-terminal-gray text-lm-gray hover:border-lm-gray"}`,children:[(0,d.jsx)("div",{className:"font-bold",children:"Custom Range"}),(0,d.jsx)("div",{className:"text-[9px] opacity-60",children:"Concentrated liquidity"})]})]})]}),"custom"===ad&&(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"text-lm-terminal-lightgray text-xs",children:["Min Price (",aB?.symbol||"B","/",aA?.symbol||"A",")"]}),(0,d.jsx)(j.p,{value:af,onValueChange:ag,placeholder:"0.0005"})]}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"text-lm-terminal-lightgray text-xs",children:["Max Price (",aB?.symbol||"B","/",aA?.symbol||"A",")"]}),(0,d.jsx)(j.p,{value:ah,onValueChange:ai,placeholder:"0.0020"})]})]}),aP?(0,d.jsx)("div",{className:"text-lm-red text-[10px]",children:aP}):null]}),aQ&&aA&&aB&&(0,d.jsxs)("div",{className:"bg-lm-black border border-lm-terminal-gray p-2 flex items-center justify-between text-[10px]",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"Low: "}),(0,d.jsx)("span",{className:"text-white lm-mono font-bold",children:"full"===ad?"0":w(aQ.lower)})]}),(0,d.jsx)("span",{className:"text-lm-terminal-gray",children:"←→"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"High: "}),(0,d.jsx)("span",{className:"text-white lm-mono font-bold",children:"full"===ad?"∞":w(aQ.upper)})]}),(0,d.jsxs)("span",{className:"text-lm-terminal-lightgray",children:[aB.symbol,"/",aA.symbol]})]}),aA&&aB?(0,d.jsx)(D,{mode:ad,lower:"custom"===ad&&aQ?aQ.lower:null,upper:"custom"===ad&&aQ?aQ.upper:null,current:aR,quoteLabel:`${aB.symbol}/${aA.symbol}`}):null,(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-xs",children:aw?.symbol||"Token A"}),ap&&Number(ap)>0&&(0,d.jsx)("button",{type:"button",onClick:()=>{$("amt0"),U(ap)},className:"text-[10px] text-lm-orange hover:underline",children:"MAX"})]}),(0,d.jsx)(j.p,{value:T,onValueChange:a=>{$("amt0"),U(a)},placeholder:"0.0"})]}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-xs",children:ax?.symbol||"Token B"}),ar&&Number(ar)>0&&(0,d.jsx)("button",{type:"button",onClick:()=>{$("amt1"),W(ar)},className:"text-[10px] text-lm-orange hover:underline",children:"MAX"})]}),(0,d.jsx)(j.p,{value:V,onValueChange:a=>{$("amt1"),W(a)},placeholder:"0.0"})]})]}),(0,d.jsxs)("label",{className:"flex items-center gap-2 text-[10px] text-lm-terminal-lightgray select-none",children:[(0,d.jsx)("input",{type:"checkbox",checked:X,onChange:a=>Y(a.target.checked),className:"accent-lm-orange"}),"Auto-adjust the other token to match the selected range"]}),X&&_?(0,d.jsx)("div",{className:"text-[10px] text-lm-orange",children:_}):null,(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-[10px] lm-upper font-bold tracking-wider",children:"Slippage Tolerance"}),(0,d.jsx)("div",{className:"flex gap-1",children:q.map(a=>(0,d.jsx)("button",{type:"button",onClick:()=>ac(a.bps),className:`flex-1 text-xs py-1.5 border transition-colors ${ab===a.bps?"border-lm-orange text-lm-orange bg-lm-orange/5":"border-lm-terminal-gray text-lm-gray hover:border-lm-gray"}`,children:a.label},a.bps))})]}),aT&&(0,d.jsxs)("div",{className:"bg-lm-black border border-lm-terminal-gray p-2.5 space-y-1.5 text-[10px]",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray lm-upper font-bold tracking-wider",children:"Deposit Preview"}),"in"===aT.mode?(0,d.jsx)("span",{className:"lm-badge lm-badge-green",children:"In Range"}):"below"===aT.mode||"above"===aT.mode?(0,d.jsx)("span",{className:"lm-badge lm-badge-orange",children:"Single-Sided"}):null]}),aT.note?(0,d.jsx)("div",{className:"text-lm-terminal-lightgray",children:aT.note}):(0,d.jsxs)("div",{className:"space-y-1",children:["below"===aT.mode&&aA&&aB?(0,d.jsxs)("div",{className:"text-lm-terminal-lightgray",children:["Current price is below your range. This deposit uses ",aA.symbol," only."]}):null,"above"===aT.mode&&aA&&aB?(0,d.jsxs)("div",{className:"text-lm-terminal-lightgray",children:["Current price is above your range. This deposit uses ",aB.symbol," only."]}):null,(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:aA?.symbol}),(0,d.jsxs)("span",{className:"text-white lm-mono font-bold",children:["Used ",aA?E((0,f.J)(aT.used0,aA.decimals)):"0",aA?` \xb7 Leftover ${E((0,f.J)(aT.leftover0,aA.decimals))}`:""]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:aB?.symbol}),(0,d.jsxs)("span",{className:"text-white lm-mono font-bold",children:["Used ",aB?E((0,f.J)(aT.used1,aB.decimals)):"0",aB?` \xb7 Leftover ${E((0,f.J)(aT.leftover1,aB.decimals))}`:""]})]})]})]}),(0,d.jsx)(i.$,{onClick:a?aX:z,loading:an,disabled:an||!!a&&(!aO||!aE&&!aS),variant:"primary",size:"lg",className:"w-full",children:an?"Processing...":a?aE?"Add Liquidity":"Create + Add Liquidity":"Connect Wallet"})]}),aj&&(0,d.jsxs)("div",{className:`text-xs p-2.5 border bg-lm-black flex items-center gap-2 ${"success"===al?"text-lm-green":"error"===al?"text-lm-red":"text-lm-gray"} ${"success"===al?"border-lm-green/20":"error"===al?"border-lm-red/20":"border-lm-terminal-gray"}`,children:["info"===al&&(0,d.jsx)("span",{className:"lm-spinner flex-shrink-0",style:{width:12,height:12,borderWidth:1.5}}),"success"===al&&(0,d.jsx)("span",{className:"lm-dot lm-dot-green flex-shrink-0"}),"error"===al&&(0,d.jsx)("span",{className:"lm-dot lm-dot-red flex-shrink-0"}),(0,d.jsx)("span",{children:aj})]})]})}},56997:(a,b,c)=>{Promise.resolve().then(c.bind(c,37632)),Promise.resolve().then(c.bind(c,72464)),Promise.resolve().then(c.bind(c,63297))},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63297:(a,b,c)=>{"use strict";c.d(b,{ExchangeBootstrap:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call ExchangeBootstrap() from the server but ExchangeBootstrap is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Volumes/2Tb-Backup/NFT Robinhood Chain/apps/web/app/exchange/ui/ExchangeBootstrap.tsx","ExchangeBootstrap")},69056:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>j});var d=c(75338),e=c(74515),f=c(11125),g=c(72464),h=c(37632),i=c(63297);function j(){return(0,d.jsx)(f.q,{title:"Stonk Exchange",subtitle:"Swap any token pair (including native ETH). Create pools and mint LP positions.",children:(0,d.jsx)(e.Suspense,{fallback:(0,d.jsx)("div",{className:"text-lm-gray text-sm p-4",children:"Loading exchange..."}),children:(0,d.jsx)(i.ExchangeBootstrap,{SwapPanel:g.SwapPanel,PoolsPanel:h.PoolsPanel})})})}},72464:(a,b,c)=>{"use strict";c.d(b,{SwapPanel:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call SwapPanel() from the server but SwapPanel is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Volumes/2Tb-Backup/NFT Robinhood Chain/apps/web/app/exchange/swap/SwapPanel.tsx","SwapPanel")},77598:a=>{"use strict";a.exports=require("node:crypto")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},87855:(a,b,c)=>{"use strict";c.d(b,{ExchangeBootstrap:()=>t});var d=c(21124),e=c(38301),f=c(29808),g=c(96126),h=c(63978),i=c(85258),j=c(66335),k=c(20003),l=c(85365),m=c(39632),n=c(16140);let o=2n**128n-1n;function p(a,b,c){return Math.pow(1.0001,a)*Math.pow(10,b-c)}function q(a){return 0!==a&&Number.isFinite(a)?a>=1e9?`${(a/1e9).toFixed(2)}B`:a>=1e6?`${(a/1e6).toFixed(2)}M`:a>=1e3?`${(a/1e3).toFixed(2)}K`:a>=1?a.toFixed(4):a>=1e-4?a.toFixed(6):a>=1e-7?a.toFixed(10):a.toExponential(2):"—"}function r(a){let b=Number(a);return isNaN(b)||0===b?"0":b>=1e6?`${(b/1e6).toFixed(2)}M`:b>=1e3?`${(b/1e3).toFixed(2)}K`:b>=1?b.toFixed(4):b>=1e-4?b.toFixed(6):b.toExponential(2)}function s(){let{address:a,walletClient:b}=(0,j.v)(),[c,g]=(0,e.useState)([]),[h,n]=(0,e.useState)(""),[s,t]=(0,e.useState)(!1),[u,v]=(0,e.useState)({}),[w,x]=(0,e.useState)({}),[y,z]=(0,e.useState)(null),A=l.$.positionManager;async function B(){if(!a||!A)return void g([]);t(!0),n("Loading positions...");try{let c=await k.R.readContract({address:A,abi:m.g4,functionName:"balanceOf",args:[a]}),d=c>50n?50:Number(c),e=[],f={};async function b(a){let b=a.toLowerCase();if(f[b])return f[b];let c=a.slice(0,6),d=18;try{c=await k.R.readContract({address:a,abi:m.Qi,functionName:"symbol"})}catch{}try{d=Number(await k.R.readContract({address:a,abi:m.Qi,functionName:"decimals"}))}catch{}return f[b]={sym:c,dec:d},f[b]}let h={};for(let c=0;c<d;c++){let d=await k.R.readContract({address:A,abi:m.g4,functionName:"tokenOfOwnerByIndex",args:[a,BigInt(c)]}),f=await k.R.readContract({address:A,abi:m.g4,functionName:"positions",args:[d]}),g=f.token0,i=f.token1,j=await b(g),n=await b(i),o=Number(f.fee),q=p(Number(f.tickLower),j.dec,n.dec),r=p(Number(f.tickUpper),j.dec,n.dec),s=0,t=`${g.toLowerCase()}-${i.toLowerCase()}-${o}`;if(void 0!==h[t])s=h[t];else if(l.$.uniFactory){try{let a=await k.R.readContract({address:l.$.uniFactory,abi:m.HB,functionName:"getPool",args:[g,i,o]});if(a&&"0x0000000000000000000000000000000000000000"!==a){let b=await k.R.readContract({address:a,abi:m.ld,functionName:"slot0"});s=p(b[1],j.dec,n.dec)}}catch{}h[t]=s}let u=s>=q&&s<=r;e.push({tokenId:d,token0:g,token1:i,fee:o,tickLower:Number(f.tickLower),tickUpper:Number(f.tickUpper),liquidity:f.liquidity,sym0:j.sym,sym1:n.sym,dec0:j.dec,dec1:n.dec,tokensOwed0:f.tokensOwed0,tokensOwed1:f.tokensOwed1,priceLower:q,priceUpper:r,currentPrice:s,inRange:u})}g(e),n("")}catch(a){n(String(a?.shortMessage||a?.message||a))}finally{t(!1)}}async function C(c){if(!a||!b||!A)return;t(!0);let d=c.tokenId.toString();v(a=>({...a,[d]:"Collecting fees..."})),x(a=>({...a,[d]:"info"}));try{let e=await b.writeContract({address:A,abi:m.g4,functionName:"collect",args:[{tokenId:c.tokenId,recipient:a,amount0Max:o,amount1Max:o}],chain:b.chain,account:a});v(a=>({...a,[d]:"Confirming..."}));let f=await k.R.waitForTransactionReceipt({hash:e});"success"===f.status?(v(a=>({...a,[d]:"Fees collected!"})),x(a=>({...a,[d]:"success"}))):(v(a=>({...a,[d]:"Tx failed"})),x(a=>({...a,[d]:"error"}))),await B()}catch(a){v(b=>({...b,[d]:String(a?.shortMessage||a?.message||a)})),x(a=>({...a,[d]:"error"}))}finally{t(!1)}}async function D(c){if(!a||!b||!A||c.liquidity<=0n)return;t(!0);let d=c.tokenId.toString();v(a=>({...a,[d]:"Removing liquidity..."})),x(a=>({...a,[d]:"info"}));try{let e=BigInt(Math.floor(Date.now()/1e3)+600),f=await b.writeContract({address:A,abi:m.g4,functionName:"decreaseLiquidity",args:[{tokenId:c.tokenId,liquidity:c.liquidity,amount0Min:0n,amount1Min:0n,deadline:e}],chain:b.chain,account:a});v(a=>({...a,[d]:"Removing... collecting tokens"})),await k.R.waitForTransactionReceipt({hash:f});let g=await b.writeContract({address:A,abi:m.g4,functionName:"collect",args:[{tokenId:c.tokenId,recipient:a,amount0Max:o,amount1Max:o}],chain:b.chain,account:a});await k.R.waitForTransactionReceipt({hash:g}),v(a=>({...a,[d]:"Liquidity removed!"})),x(a=>({...a,[d]:"success"})),await B()}catch(a){v(b=>({...b,[d]:String(a?.shortMessage||a?.message||a)})),x(a=>({...a,[d]:"error"}))}finally{t(!1)}}if(!a)return(0,d.jsxs)("div",{className:"text-lm-gray text-sm p-6 text-center",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-lg mb-1",children:"No Wallet Connected"}),(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-xs",children:"Connect your wallet to view and manage LP positions."})]});let E=c.filter(a=>a.liquidity>0n),F=c.filter(a=>a.liquidity<=0n);return(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("div",{className:"flex items-center gap-3",children:c.length>0&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("span",{className:"text-lm-terminal-lightgray text-[10px] lm-upper font-bold tracking-wider",children:[E.length," Active"]}),F.length>0&&(0,d.jsxs)("span",{className:"text-lm-terminal-lightgray text-[10px] lm-upper tracking-wider opacity-50",children:[F.length," Closed"]})]})}),(0,d.jsx)(i.$,{onClick:B,disabled:s,className:"text-lm-orange text-xs border border-lm-terminal-gray hover:border-lm-orange px-3 py-1 transition-colors",children:s?"Loading...":"Refresh"})]}),0===c.length?(0,d.jsxs)("div",{className:"text-center py-8 space-y-2",children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-lg",children:s?"Loading...":"No Positions"}),(0,d.jsx)("div",{className:"text-lm-terminal-lightgray text-xs opacity-60",children:h||"Create an LP position in the Pools tab to start earning fees."})]}):(0,d.jsx)("div",{className:"space-y-2",children:c.map(a=>{let b=a.tokenId.toString(),c=a.liquidity>0n,e=a.tokensOwed0>0n||a.tokensOwed1>0n,g=u[b],h=w[b]||"info",j=y===b,k=`${(a.fee/1e4).toFixed(a.fee<1e3?2:+(a.fee<1e4))}%`;return(0,d.jsxs)("div",{className:`bg-lm-terminal-darkgray border transition-all lm-card-hover ${c&&a.inRange?"border-lm-green/30 lm-in-range":c?"border-lm-orange/30 lm-out-of-range":"border-lm-terminal-gray"}`,children:[(0,d.jsxs)("button",{type:"button",onClick:()=>z(j?null:b),className:"w-full p-3 flex items-center justify-between text-left hover:bg-lm-black/20",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,d.jsx)("span",{className:`lm-dot ${c?a.inRange?"lm-dot-green lm-dot-pulse":"lm-dot-red":"lm-dot-gray"}`}),(0,d.jsxs)("span",{className:"text-white font-bold text-sm",children:[a.sym0,"/",a.sym1]}),(0,d.jsx)("span",{className:"text-lm-terminal-lightgray text-[10px] bg-lm-black px-1.5 py-0.5 border border-lm-terminal-gray lm-mono",children:k}),(0,d.jsxs)("span",{className:"text-lm-terminal-lightgray text-[10px] lm-mono opacity-50",children:["#",a.tokenId.toString()]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[c?(0,d.jsx)("span",{className:`lm-badge font-bold ${a.inRange?"lm-badge-filled-green":"lm-badge-filled-red"}`,children:a.inRange?"IN RANGE":"OUT OF RANGE"}):(0,d.jsx)("span",{className:"lm-badge lm-badge-gray",children:"CLOSED"}),e&&(0,d.jsx)("span",{className:"lm-badge lm-badge-filled-green",children:"FEES"}),(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:`w-3 h-3 text-lm-terminal-lightgray transition-transform ${j?"rotate-180":""}`,children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M4.22 6.22a.75.75 0 011.06 0L8 8.94l2.72-2.72a.75.75 0 111.06 1.06l-3.25 3.25a.75.75 0 01-1.06 0L4.22 7.28a.75.75 0 010-1.06z",clipRule:"evenodd"})})]})]}),(0,d.jsxs)("div",{className:"px-3 pb-2 flex items-center gap-4 text-[10px] flex-wrap",children:[a.currentPrice>0&&(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"Price:"}),(0,d.jsx)("span",{className:"text-white lm-mono font-bold",children:q(a.currentPrice)})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(0,d.jsx)("span",{className:"text-lm-terminal-lightgray",children:"Range:"}),(0,d.jsx)("span",{className:"text-white lm-mono",children:q(a.priceLower)}),(0,d.jsx)("span",{className:"text-lm-terminal-gray",children:"—"}),(0,d.jsx)("span",{className:"text-white lm-mono",children:q(a.priceUpper)})]})]}),c&&a.currentPrice>0&&(0,d.jsx)("div",{className:"px-3 pb-2",children:(0,d.jsxs)("div",{className:"relative h-1.5 bg-lm-black rounded-full overflow-hidden",children:[(0,d.jsx)("div",{className:"absolute inset-0 bg-lm-orange/20 rounded-full",style:{left:"10%",right:"10%"}}),(()=>{let b=Math.min(a.priceLower,.5*a.currentPrice),c=Math.max(a.priceUpper,2*a.currentPrice)-b;if(c<=0)return null;let e=(a.priceLower-b)/c*100,f=(a.priceUpper-b)/c*100,g=(a.currentPrice-b)/c*100;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:`absolute top-0 h-full ${a.inRange?"bg-lm-green/40":"bg-lm-orange/40"}`,style:{left:`${e}%`,width:`${f-e}%`}}),(0,d.jsx)("div",{className:"absolute top-0 w-1 h-full bg-white rounded-full",style:{left:`${g}%`,transform:"translateX(-50%)"}})]})})()]})}),j&&(0,d.jsxs)("div",{className:"px-3 pb-3 space-y-2 border-t border-lm-terminal-gray",children:[(0,d.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 pt-2 text-[10px]",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"text-lm-terminal-lightgray lm-upper tracking-wider",children:["Price Range (",a.sym1,"/",a.sym0,")"]}),(0,d.jsxs)("div",{className:"text-white lm-mono text-xs mt-0.5",children:[q(a.priceLower)," — ",q(a.priceUpper)]})]}),a.currentPrice>0&&(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray lm-upper tracking-wider",children:"Current Price"}),(0,d.jsxs)("div",{className:"text-white lm-mono text-xs mt-0.5",children:[q(a.currentPrice)," ",a.sym1,"/",a.sym0]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-lm-terminal-lightgray lm-upper tracking-wider",children:"Fee Tier"}),(0,d.jsx)("div",{className:"text-white text-xs mt-0.5",children:k})]})]}),e&&(0,d.jsxs)("div",{className:"bg-lm-black border border-lm-green/20 p-2 text-xs space-y-0.5",children:[(0,d.jsx)("div",{className:"text-lm-green text-[10px] font-bold lm-upper tracking-wider",children:"Uncollected Fees"}),(0,d.jsxs)("div",{className:"flex gap-4 text-white lm-mono",children:[a.tokensOwed0>0n&&(0,d.jsxs)("span",{children:[r((0,f.J)(a.tokensOwed0,a.dec0))," ",a.sym0]}),a.tokensOwed1>0n&&(0,d.jsxs)("span",{children:[r((0,f.J)(a.tokensOwed1,a.dec1))," ",a.sym1]})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2 flex-wrap pt-1",children:[(0,d.jsx)(i.$,{size:"sm",className:"bg-lm-green/10 text-lm-green border-lm-green/30 hover:bg-lm-green/20 hover:border-lm-green",onClick:()=>C(a),disabled:s,children:"Collect Fees"}),c&&(0,d.jsx)(i.$,{size:"sm",variant:"danger",onClick:()=>D(a),disabled:s,children:"Remove All Liquidity"}),g&&(0,d.jsxs)("div",{className:"flex items-center gap-1.5",children:["info"===h&&(0,d.jsx)("span",{className:"lm-spinner",style:{width:10,height:10,borderWidth:1}}),"success"===h&&(0,d.jsx)("span",{className:"lm-dot lm-dot-green"}),"error"===h&&(0,d.jsx)("span",{className:"lm-dot lm-dot-red"}),(0,d.jsx)("span",{className:`text-[10px] ${"success"===h?"text-lm-green":"error"===h?"text-lm-red":"text-lm-gray"}`,children:g})]})]})]})]},b)})}),h&&c.length>0&&(0,d.jsxs)("div",{className:"text-xs p-2.5 border border-lm-red/20 bg-lm-black flex items-center gap-2 text-lm-red",children:[(0,d.jsx)("span",{className:"lm-dot lm-dot-red flex-shrink-0"}),(0,d.jsx)("span",{children:h})]})]})}function t({SwapPanel:a,PoolsPanel:b}){let c=(0,e.useMemo)(()=>[{id:"swap",label:"Swap",hint:"Quote + swap any token pair"},{id:"pools",label:"Pools",hint:"Create pools + add liquidity"},{id:"positions",label:"Positions",hint:"Manage your LP positions"}],[]),[f,i]=(0,e.useState)("swap"),j=(0,e.useCallback)(a=>{["swap","flip_tokens","max_balance","set_fee","set_slippage"].includes(a.type)?i("swap"):["add_liquidity","create_pool"].includes(a.type)?i("pools"):["collect_fees","remove_liquidity","refresh_positions"].includes(a.type)?i("positions"):"switch_tab"===a.type&&["swap","pools","positions"].includes(a.tab)&&i(a.tab)},[]);return(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)(n.jc,{context:"exchange",onIntent:j,placeholder:"swap 10 ETH for TSLA \xb7 add liquidity \xb7 create pool \xb7 collect fees \xb7 help"}),(0,d.jsxs)(g.Z,{title:"Exchange",hint:"Swap any token pair. Native ETH supported. Create and manage LP positions.",right:(0,d.jsx)(h.Z,{tabs:c,active:f,onChange:i}),children:["swap"===f?(0,d.jsx)(a,{}):null,"pools"===f?(0,d.jsx)(b,{}):null,"positions"===f?(0,d.jsx)(s,{}):null]})]})}},93445:(a,b,c)=>{Promise.resolve().then(c.bind(c,53058)),Promise.resolve().then(c.bind(c,52402)),Promise.resolve().then(c.bind(c,87855))},93992:(a,b,c)=>{"use strict";c.d(b,{V:()=>g});var d=c(20003),e=c(85365),f=c(39632);async function g(){if(!e.$.tokenRegistry)return[];let a=await d.R.readContract({address:e.$.tokenRegistry,abi:f.wn,functionName:"tokenCount"}),b=[];for(let c=0n;c<a;c++){let a=await d.R.readContract({address:e.$.tokenRegistry,abi:f.wn,functionName:"tokenAt",args:[c]}),g=await d.R.readContract({address:e.$.tokenRegistry,abi:f.wn,functionName:"getToken",args:[a]});g?.whitelisted&&b.push({address:a,symbol:g.symbol,decimals:Number(g.decimals),logoURI:g.logoURI||void 0,metadataURI:g.metadataURI||void 0})}return b}}};var b=require("../../webpack-runtime.js");b.C(a);var c=b.X(0,[617,446,295,632,408],()=>b(b.s=30783));module.exports=c})();